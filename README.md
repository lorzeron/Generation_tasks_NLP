# Generation_tasks_NLP
Чат-бот "Доктор Хаус"
Описание проекта
Чат-бот, имитирующий стиль общения доктора Хауса из одноименного сериала. Бот использует подход retrieval-based, основанный на поиске наиболее подходящей реплики из базы данных с использованием TF-IDF и косинусного сходства.

Используемые данные
Источник данных: Транскрипты первого сезона сериала "Доктор Хаус" (файл season1.csv).

Структура данных:
    line — текст реплики.
    name — имя персонажа.

Пример данных:
    line,name
    "That you know of.",House
    "The color?",House

Предобработка данных
    Фильтрация: 
        Оставлены только реплики персонажа Хауса.

    Очистка текста:
        Удаление текста в квадратных скобках (например, [действие]).
        Приведение к нижнему регистру.
        Удаление стоп-слов (на английском языке).
        Удаление цифр, пунктуации и HTML-тегов.

    Результат: 
        Очищенные данные сохранены в файл data/dialogues_clean.csv.

Обучение модели
    Метод: TF-IDF + косинусное сходство.

    Процесс:
        1.Векторизация текста с использованием TfidfVectorizer.
        2.Сохранение векторизатора (vectorizer.pkl) и TF-IDF матрицы (tfidf_matrix.pkl).

    Визуализация: 
        Построен график распределения длины реплик (plots/dialogue_length_distribution.png).

Инференс модели
    Логика работы:
        1.Пользовательский запрос преобразуется в TF-IDF вектор.
        2.Находится реплика с максимальным косинусным сходством.
        3.Возвращается наиболее подходящая реплика.

    Пример работы:
    Завпрос : What's wrong with me?
    Бот: Okay, you're upset because they threw you out of their lounge.
    
    
Веб-интерфейс
    Фреймворк: Gradio.

    Запуск:
    Откройте интерфейс по адресу: http://127.0.0.1:8001/.
    Введите вопрос в текстовое поле.
    Получите ответ от бота.

Установка и запуск
        Установите зависимости:
        pip install -r requirements.txt
    Запустите пайплайн:
        python preprocess.py
        python train_model.py
        python ui.py
    Откройте веб-интерфейс в браузере: http://127.0.0.1:8001/.

Производительность
Тест скорости: Время обработки 3 запросов — ~0.004 секунды (см. benchmark.py).
Оптимизация: Использование TF-IDF и косинусного сходства обеспечивает быстрый и точный поиск реплик.


    Generation_tasks_NLP/
    |-- data/                    # Данные для обучения и тестирования
    |   |-- dialogues_clean.csv  # Очищенные диалоги
    |   |-- season1.csv          # Данные первого сезона
    |-- model/                   # Файлы модели
    |   |-- tfidf_matrix.pkl     # Матрица TF-IDF
    |   |-- vectorizer.pkl       # Сериализованный векторизатор
    |-- plots/                   # Графики и визуализации
    |   |-- dialogue_length_distribution.png  # График распределения длины диалогов
    |-- benchmark.py             # Скрипт для оценки производительности
    |-- inference.py             # Код для инференса модели
    |-- preprocess.py            # Скрипт предобработки данных
    |-- requirements.txt         # Зависимости проекта
    |-- train_model.py           # Код для обучения модели
    |-- ui.py                    # Код интерфейса


Итеративный процесс улучшений
Baseline: Первая версия использовала все реплики сезона без фильтрации по персонажу. Ответы были нерелевантными.

Улучшение 1: Добавлена фильтрация по персонажу Хауса. Ответы стали более характерными.

Улучшение 2: Удаление текста в квадратных скобках и стоп-слов повысило качество предобработки.

Улучшение 3: Визуализация распределения длины реплик помогла оценить качество данных.
